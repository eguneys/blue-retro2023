var t=Object.defineProperty,s=(s,e,n)=>(((s,e,n)=>{e in s?t(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n})(s,"symbol"!=typeof e?e+"":e,n),n);const e=new class{constructor(){s(this,"ticks_per_second",1e3),s(this,"ticks",0),s(this,"seconds",0),s(this,"delta",0),s(this,"previous_ticks",0),s(this,"previous_seconds",0),s(this,"pause_timer",0)}t(t){t>=this.i&&(this.i=t)}h(t,s=0){let e=this.A,n=this.delta;return Math.floor((e-s-n)/t)<Math.floor((e-s)/t)}o(t,s){let e=Math.floor(t)-this.delta;return t>=s&&e<s}u(t,s=0){let e=this.A;return i=2*t,(n=e-s)-Math.floor(n/i)*i>=t;var n,i}};const n=new class{constructor(){s(this,"app_time_last",0),s(this,"app_time_accumulator",0)}l(t){const s=()=>{t.C()},n=i=>{let h=i-this.I;this.I=i,this.m+=h,e.delta=h/e.p,e.i>0?e.i-=e.delta:(e.g=e.k,e.k+=h,e.D=e.A,e.A+=e.delta,s()),t.M(),requestAnimationFrame(n)};requestAnimationFrame(n)}};const i=new class{constructor(){s(this,"image"),s(this,"info")}async load(){var t;this.B=await(t="data:image/png;base64,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",new Promise((s=>{let e=new Image;e.onload=()=>s(e),e.src=t}))),this.info="player\n\n0*1*hit\n2*3*jump\n4*5*attack\n6*7*idle\n8*11*walk\n\n4*4*16*16*88*88*24*24*100\n4*4*16*16*112*88*24*24*100\n4*4*16*16*88*112*24*24*100\n4*4*16*16*112*112*24*24*100\n4*4*16*16*88*136*24*24*100\n4*4*16*16*112*136*24*24*100\n4*4*16*16*88*0*24*24*100\n4*4*16*16*112*0*24*24*100\n4*4*16*16*88*24*24*24*100\n4*4*16*16*112*24*24*24*100\n4*4*16*16*88*48*24*24*100\n4*4*16*16*112*48*24*24*100\n\n\nsun\n\n0*0*idle\n1*1*idle2\n\n4*4*80*80*0*0*88*88*100\n4*4*80*80*0*88*88*88*100".split("\n\n\n").map((t=>{let[s,e,n]=t.split("\n\n");return{name:s,tags:e.split("\n").map((t=>{let[s,e,n]=t.split("*");return{from:parseInt(s),to:parseInt(e),name:n}})),J:n.split("\n").map((t=>{let[s,e,n,i,h,a,r,A,o]=t.split("*").map((t=>parseInt(t)));return{x:s,y:e,w:n,Y:i,K:h,S:a,W:r,R:A,duration:o}}))}}))}},h=class{constructor(t){s(this,"ctx"),this.canvas=t,this.U=t.getContext("2d"),this.U.imageSmoothingEnabled=!1}T(t,s,e,n=1,i=1){let{K:h,S:a,W:r,R:A}=t.N,o=s,c=e;this.F(o,c,h,a,r,A,n,i)}F(t,s,e,n,h,a,r,A){let{U:o}=this,{B:c}=i,u=h,l=a,C=u*r,I=l*A;o.drawImage(c,e,n,u,l,t,s,C,I)}};s(h,"make",(()=>{let t=document.createElement("canvas");return t.width=320,t.height=180,new h(t)}));let a=h;class r{constructor(){s(this,"_data"),s(this,"objects"),this.V=[]}L(t){return this.G=t,this}v(t,s){return(new t).L(s).init()}make(t,s={}){let e=this.v(t,s);return this.V.push(e),e}init(){return this.q(),this}update(){this.V.forEach((t=>t.update())),this.j()}P(t){this.V.forEach((s=>s.P(t))),this.H(t)}q(){}j(){}H(t){}}class A extends r{constructor(){super(...arguments),s(this,"x",0),s(this,"y",0),s(this,"scale_x",1),s(this,"scale_y",1),s(this,"_current_frame",0),s(this,"__elapsed",0)}get data(){return this.G}get info(){let t=i.info.find((t=>t.name));if(!t)throw`nosprite ${this.O}`;return t}get tag(){let t=this.info.tags.find((t=>t.name===this._));if(!t)throw`notag ${this.O} ${this._}`;return t}get O(){return this.data.name}get _(){return this.data.tag||"idle"}X(t,s){this.x=t,this.y=s}get N(){let{from:t}=this.tag;return this.info.J[this.Z+t]}$(t){this.data.tag=t,this.Z=0,this.tt=0}j(){let{from:t,to:s}=this.tag,{duration:n}=this.N,i=s-t;this.tt+=1e3*e.delta,this.tt>=n&&(this.tt-=n,this.Z===i?this.Z=0:this.Z+=1)}H(t){let{x:s,y:e,st:n,et:i}=this;t.T(this,s,e,n,i)}}const o={volume:.3,sampleRate:44100,x:new AudioContext,play:function(...t){return this.nt(this.it(...t))},nt:function(...t){const s=this.x.createBuffer(t.length,t[0].length,this.sampleRate),e=this.x.createBufferSource();return t.map(((t,e)=>s.getChannelData(e).set(t))),e.buffer=s,e.connect(this.x.destination),e.start(),e},it:function(t=1,s=.05,e=220,n=0,i=0,h=.1,a=0,r=1,A=0,o=0,c=0,u=0,l=0,C=0,I=0,Q=0,E=0,m=1,p=0,g=0){let k,w,y=2*Math.PI,d=this.sampleRate,D=A*=500*y/d/d,M=e*=(1+2*s*Math.random()-s)*y/d,x=[],B=0,J=0,Y=0,K=1,S=0,W=0,b=0;for(o*=500*y/d**3,I*=y/d,c*=y/d,u*=d,l=l*d|0,w=(n=n*d+9)+(p*=d)+(i*=d)+(h*=d)+(E*=d)|0;Y<w;x[Y++]=b)++W%(100*Q|0)||(b=a?a>1?a>2?a>3?Math.sin((B%y)**3):Math.max(Math.min(Math.tan(B),1),-1):1-(2*B/y%2+2)%2:1-4*Math.abs(Math.round(B/y)-B/y):Math.sin(B),b=(l?1-g+g*Math.sin(y*Y/l):1)*(b>0?1:-1)*Math.abs(b)**r*t*this.volume*(Y<n?Y/n:Y<n+p?1-(Y-n)/p*(1-m):Y<n+p+i?m:Y<w-E?(w-Y-E)/h*m:0),b=E?b/2+(E>Y?0:(Y<w-E?1:(w-Y)/E)*x[Y-E|0]/2):b),k=(e+=A+=o)*Math.cos(I*J++),B+=k-k*C*(1-1e9*(Math.sin(Y)+1)%2),K&&++K>u&&(e+=c,M+=c,K=0),!l||++S%l||(e=M,A=D,K||(K=1));return x},ht:function(t=0,s=440){return s*2**(t/12)}};let c={drum:[,,129,.01,,.15,,,,,,,,5]};const u=class{constructor(){s(this,"_fxs")}fx(t){!function(...t){o.play(...t)}(...this.rt[t])}};s(u,"make",(()=>{let t=new u;return t.rt=c,t}));const l=u.make(),C=class extends r{q(){this.make(A,{name:"player"}).X(0,0),l.fx("drum")}H(t){}};s(C,"make",(()=>(new C).init()));let I=C;!async function(t){await i.load(),function(t){let s=a.make(),e=I.make();n.l({C(){e.update()},M(){e.P(s)}}),t.appendChild(s.canvas)}(t)}(document.getElementById("app"));
