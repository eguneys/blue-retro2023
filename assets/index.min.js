var t=Object.defineProperty,s=(s,e,i)=>(((s,e,i)=>{e in s?t(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i})(s,"symbol"!=typeof e?e+"":e,i),i);const e=new class{constructor(){s(this,"ticks_per_second",1e3),s(this,"ticks",0),s(this,"seconds",0),s(this,"delta",0),s(this,"previous_ticks",0),s(this,"previous_seconds",0),s(this,"pause_timer",0)}t(t){t>=this.i&&(this.i=t)}h(t,s=0){let e=this.o,i=this.delta;return Math.floor((e-s-i)/t)<Math.floor((e-s)/t)}u(t,s){let e=Math.floor(t)-this.delta;return t>=s&&e<s}A(t,s=0){let e=this.o;return n=2*t,(i=e-s)-Math.floor(i/n)*n>=t;var i,n}};const i=new class{constructor(){s(this,"app_time_last"),s(this,"app_time_accumulator",0)}l(t){const s=()=>{t.p()},i=n=>{let h=Math.min(25,n-(this.C??n));this.C=n,this.g+=h,e.delta=h/e.ticks_per_second,e.i>0?e.i-=e.delta:(e.m=e.I,e.I+=h,e.k=e.o,e.o+=e.delta,s()),t.D(),requestAnimationFrame(i)};requestAnimationFrame(i)}},n=class{constructor(){s(this,"_btn_pre",!1),s(this,"_btn",0)}get M(){return this.B}get J(){return this.Y>0}K(t){this.Y="down"===t?1:0}update(){1!==this.Y||this.B?this.B=!1:this.B=!0,1===this.Y&&(this.Y=2)}};s(n,"make",(()=>new n));let h=n;const r=new class{constructor(){s(this,"action_map"),s(this,"key_map"),this.S={jump:h.make(),left:h.make(),right:h.make(),down:h.make()},this.W={w:"jump",a:"left",s:"down",d:"right",ArrowUp:"jump",ArrowLeft:"left",ArrowDown:"down",ArrowRight:"right"},document.addEventListener("keydown",(t=>{var s;return null==(s=this.S[this.W[t.key]])?void 0:s.K("down")})),document.addEventListener("keyup",(t=>{var s;return null==(s=this.S[this.W[t.key]])?void 0:s.K("up")}))}M(t){return this.S[t].M}J(t){return this.S[t].J}update(){for(let t of Object.keys(this.S))this.S[t].update()}};const a=new class{constructor(){s(this,"image"),s(this,"info")}async load(){var t;this.R=await(t="data:image/png;base64,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",new Promise((s=>{let e=new Image;e.onload=()=>s(e),e.src=t}))),this.info="player\n\n0*1*hit\n2*3*jump\n4*5*attack\n6*7*idle\n8*11*walk\n\n4*4*16*16*88*88*24*24*100\n4*4*16*16*112*88*24*24*100\n4*4*16*16*88*112*24*24*100\n4*4*16*16*112*112*24*24*100\n4*4*16*16*88*136*24*24*100\n4*4*16*16*112*136*24*24*100\n4*4*16*16*88*0*24*24*100\n4*4*16*16*112*0*24*24*100\n4*4*16*16*88*24*24*24*100\n4*4*16*16*112*24*24*24*100\n4*4*16*16*88*48*24*24*100\n4*4*16*16*112*48*24*24*100\n\n\nsun\n\n0*0*idle\n1*1*idle2\n\n4*4*80*80*0*0*88*88*100\n4*4*80*80*0*88*88*88*100".split("\n\n\n").map((t=>{let[s,e,i]=t.split("\n\n");return{name:s,tags:e.split("\n").map((t=>{let[s,e,i]=t.split("*");return{from:parseInt(s),to:parseInt(e),name:i}})),U:i.split("\n").map((t=>{let[s,e,i,n,h,r,a,o,u]=t.split("*").map((t=>parseInt(t)));return{x:s,y:e,w:i,_:n,v:h,T:r,N:a,j:o,duration:u}}))}}))}},o="#735973",u=class{constructor(t){s(this,"ctx"),this.canvas=t,this.F=t.getContext("2d"),this.F.imageSmoothingEnabled=!1}clear(){let{F:t}=this;t.fillStyle=o,t.fillRect(0,0,320,180)}L(t,s,e,i=1,n=1){let{v:h,T:r,N:a,j:o}=t.current_frame,u=s,A=e;this.V(u,A,h,r,a,o,i,n)}V(t,s,e,i,n,h,r,o){let{F:u}=this,{R:A}=a,c=n,l=h,p=c*r,C=l*o;u.drawImage(A,e,i,c,l,t,s,p,C)}};s(u,"make",(()=>{let t=document.createElement("canvas");return t.width=320,t.height=180,new u(t)}));let A=u;class c{constructor(){s(this,"_data"),s(this,"objects"),this.G=[]}q(t){return this.P=t,this}H(t,s){return(new t).q(s).init()}make(t,s={}){let e=this.H(t,s);return this.G.push(e),e}init(){return this.O(),this}update(){this.G.forEach((t=>t.update())),this.X()}Z(t){this.$(t),this.G.forEach((s=>s.Z(t))),this.tt(t)}O(){}X(){}tt(t){}$(t){}}class l extends c{constructor(){super(...arguments),s(this,"x",0),s(this,"y",0),s(this,"scale_x",1),s(this,"scale_y",1),s(this,"_current_frame",0),s(this,"__elapsed",0)}get data(){return this.P}get info(){let t=a.info.find((t=>t.name));if(!t)throw`nosprite ${this.st}`;return t}get tag(){let t=this.info.tags.find((t=>t.name===this.et));if(!t)throw`notag ${this.st} ${this.et}`;return t}get st(){return this.data.name}get et(){return this.data.tag||"idle"}it(t,s){this.x=t,this.y=s}get current_frame(){let{from:t}=this.tag;return this.info.U[this._current_frame+t]}nt(t){this.data.tag=t,this._current_frame=0,this.__elapsed=0}X(){let{from:t,to:s}=this.tag,{duration:i}=this.current_frame,n=s-t;this.__elapsed+=1e3*e.delta,this.__elapsed>=i&&(this.__elapsed-=i,this._current_frame===n?this._current_frame=0:this._current_frame+=1)}tt(t){let{x:s,y:e,ht:i,rt:n}=this;t.L(this,s,e,i,n)}}const p={volume:.3,sampleRate:44100,x:new AudioContext,play:function(...t){return this.ot(this.ut(...t))},ot:function(...t){const s=this.x.createBuffer(t.length,t[0].length,this.sampleRate),e=this.x.createBufferSource();return t.map(((t,e)=>s.getChannelData(e).set(t))),e.buffer=s,e.connect(this.x.destination),e.start(),e},ut:function(t=1,s=.05,e=220,i=0,n=0,h=.1,r=0,a=1,o=0,u=0,A=0,c=0,l=0,p=0,C=0,d=0,w=0,g=1,m=0,I=0){let Q,E,k=2*Math.PI,y=this.sampleRate,x=o*=500*k/y/y,D=e*=(1+2*s*Math.random()-s)*k/y,M=[],B=0,b=0,J=0,Y=1,K=0,f=0,S=0;for(u*=500*k/y**3,C*=k/y,A*=k/y,c*=y,l=l*y|0,E=(i=i*y+9)+(m*=y)+(n*=y)+(h*=y)+(w*=y)|0;J<E;M[J++]=S)++f%(100*d|0)||(S=r?r>1?r>2?r>3?Math.sin((B%k)**3):Math.max(Math.min(Math.tan(B),1),-1):1-(2*B/k%2+2)%2:1-4*Math.abs(Math.round(B/k)-B/k):Math.sin(B),S=(l?1-I+I*Math.sin(k*J/l):1)*(S>0?1:-1)*Math.abs(S)**a*t*this.volume*(J<i?J/i:J<i+m?1-(J-i)/m*(1-g):J<i+m+n?g:J<E-w?(E-J-w)/h*g:0),S=w?S/2+(w>J?0:(J<E-w?1:(E-J)/w)*M[J-w|0]/2):S),Q=(e+=o+=u)*Math.cos(C*b++),B+=Q-Q*p*(1-1e9*(Math.sin(J)+1)%2),Y&&++Y>c&&(e+=A,D+=A,Y=0),!l||++K%l||(e=D,o=x,Y||(Y=1));return M},At:function(t=0,s=440){return s*2**(t/12)}};let C={start:[,,129,.01,,.15,,,,,,,,5]};const d=class{constructor(){s(this,"_fxs")}fx(t){let s=this.ct[t];if(!s)throw`nosound ${t}`;!function(...t){p.play(...t)}(...s)}};s(d,"make",(()=>{let t=new d;return t.ct=C,t}));const w=d.make();class g extends c{constructor(){super(...arguments),s(this,"world")}init(){return this.lt=this.make(I),this.O(),this}}class m extends c{constructor(){super(...arguments),s(this,"_w"),s(this,"_h"),s(this,"_x"),s(this,"vx")}get data(){return this.P}get x(){return this.Ct}get w(){return this.dt}get _(){return this.wt}O(){this.Ct=this.data.x??0,this.dt=this.data.w,this.wt=this.data._,this.gt=0}}class I extends c{get It(){return this.G}body(t,s={}){this.make(t,s)}X(){}}class Q extends m{}class E extends c{O(){this.make(x)}X(){r.M("jump")&&w.fx("start")}}const k=class extends c{O(){this.make(l,{name:"player"}).it(0,0),this.make(E)}$(t){t.clear()}};s(k,"make",(()=>(new k).init()));let y=k;class x extends g{O(){this.lt.body(Q)}}!async function(t){await a.load(),function(t){let s=A.make(),e=y.make();i.l({p(){r.update(),e.update()},D(){e.Z(s)}}),t.appendChild(s.canvas)}(t)}(document.getElementById("app"));
