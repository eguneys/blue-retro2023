var t=Object.defineProperty,s=(s,i,e)=>(((s,i,e)=>{i in s?t(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e})(s,"symbol"!=typeof i?i+"":i,e),e);const i=new class{constructor(){s(this,"ticks_per_second",1e3),s(this,"ticks",0),s(this,"seconds",0),s(this,"delta",0),s(this,"previous_ticks",0),s(this,"previous_seconds",0),s(this,"pause_timer",0)}t(t){t>=this.i&&(this.i=t)}o(t,s=0){let i=this.seconds,e=this.delta;return Math.floor((i-s-e)/t)<Math.floor((i-s)/t)}l(t,s){let i=Math.floor(t)-this.delta;return t>=s&&i<s}A(t,s=0){let i=this.seconds;return h=2*t,(e=i-s)-Math.floor(e/h)*h>=t;var e,h}};const e=new class{constructor(){s(this,"app_time_last"),s(this,"app_time_accumulator",0)}u(t){const s=()=>{t.g()},e=h=>{let r=Math.min(25,h-(this._??h));this._=h,this.p+=r,i.delta=r/i.ticks_per_second,i.i>0?i.i-=i.delta:(i.m=i.M,i.M+=r,i.C=i.seconds,i.seconds+=i.delta,s()),t.B(),requestAnimationFrame(e)};requestAnimationFrame(e)}};const h=new class{constructor(){s(this,"bounds"),s(this,"_click"),s(this,"_click_clear",!0),s(this,"_move"),s(this,"_move_clear",!0)}get click(){return this.k}get move(){return this.v}D(t){this.F=!1,this.v=t}L(t){this.H=!1,this.k=t}I(t){const s=t=>{let s=[t.clientX,t.clientY],{bounds:i}=this;return s[0]-=i.left,s[1]-=i.top,s[0]/=i.width,s[1]/=i.height,s};t.addEventListener("click",(t=>this.L(s(t)))),t.addEventListener("mousemove",(t=>this.D(s(t))));const i=()=>{this.bounds=t.getBoundingClientRect()};document.addEventListener("scroll",i),window.addEventListener("resize",i),i()}update(){this.H?this.k&&(this.H=!1,this.k=void 0):this.k&&(this.H=!0),this.F?this.v&&(this.F=!1,this.v=void 0):this.v&&(this.F=!0)}},r=class{constructor(){s(this,"_btn_pre",!1),s(this,"_btn",0)}get U(){return this.S}get P(){return this.Y>0}R(t){this.Y="down"===t?1:0}update(){1!==this.Y||this.S?this.S=!1:this.S=!0,1===this.Y&&(this.Y=2)}};s(r,"make",(()=>new r));let n=r;const o=new class{constructor(){s(this,"action_map"),s(this,"key_map"),this.Z={jump:n.make(),left:n.make(),right:n.make(),down:n.make()},this.j={w:"jump",a:"left",s:"down",d:"right",ArrowUp:"jump",ArrowLeft:"left",ArrowDown:"down",ArrowRight:"right"},document.addEventListener("keydown",(t=>{var s;return null==(s=this.Z[this.j[t.key]])?void 0:s.R("down")})),document.addEventListener("keyup",(t=>{var s;return null==(s=this.Z[this.j[t.key]])?void 0:s.R("up")}))}U(t){return this.Z[t].U}P(t){return this.Z[t].P}update(){for(let t of Object.keys(this.Z))this.Z[t].update()}};const a=new class{constructor(){s(this,"image"),s(this,"info")}async load(){var t;this.K=await(t="data:image/png;base64,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",new Promise((s=>{let i=new Image;i.onload=()=>s(i),i.src=t}))),this.info="player\n\n0*1*hit\n2*3*jump\n4*5*attack\n6*7*idle\n8*11*walk\n\n0*0*16*16*80*80*16*16\n0*0*16*16*96*80*16*16\n0*0*16*16*112*80*16*16\n0*0*16*16*80*96*16*16\n0*0*16*16*96*96*16*16\n0*0*16*16*112*96*16*16\n0*0*16*16*80*112*16*16\n0*0*16*16*96*112*16*16\n0*0*16*16*112*112*16*16\n0*0*16*16*80*128*16*16\n0*0*16*16*96*128*16*16\n0*0*16*16*112*128*16*16\n\n\nsun\n\n0*0*idle\n1*1*idle2\n\n0*0*80*80*0*0*80*80\n0*0*80*80*0*80*80*80".split("\n\n\n").map((t=>{let[s,i,e]=t.split("\n\n");return{name:s,tags:i.split("\n").map((t=>{let[s,i,e]=t.split("*");return{from:parseInt(s),to:parseInt(i),name:e}})),W:e.split("\n").map((t=>{let[s,i,e,h,r,n,o,a]=t.split("*").map((t=>parseInt(t)));return{fx:s,fy:i,G:e,J:h,X:r,N:n,q:o,O:a,duration:100}}))}}))}},c=class{constructor(t,s,i,e){this.r=t,this.T=s,this.b=i,this.a=e}get css(){return`rgba(${this.r}, ${this.T}, ${this.b}, ${this.a})`}};s(c,"hex",(t=>new c((16711680&t)>>16,(65280&t)>>8,255&t,255))),s(c,"lightblue",c.hex(4293053)),s(c,"background",c.hex(11841221)),s(c,"light",c.hex(15657718)),s(c,"darkblue",c.hex(1586258)),s(c,"darkred",c.hex(11807859)),s(c,"red",c.hex(14569562)),s(c,"green",c.hex(2158244)),s(c,"purple",c.hex(9142708)),s(c,"all",[c.background,c.darkblue,c.light,c.lightblue,c.red,c.darkred,c.green,c.purple]),s(c,"lerp",((t,s,i)=>(i<0&&(i=0),i>1&&(i=1),new c(t.r+(s.r-t.r)*i,t.T+(s.T-t.T)*i,t.b+(s.b-t.b)*i,t.a+(s.a-t.a)*i))));let l=c;const A=class{constructor(t,s){this.canvas=t,this.V=s}get width(){return this.canvas.width}get height(){return this.canvas.height}clear(t=l.background){let{V:s}=this;s.clearRect(0,0,this.width,this.height)}$(t,s){let{V:i}=this;i.save(),i.translate(t,s)}pop(){let{V:t}=this;t.restore()}rect(t=l.red,s,i,e,h){let{V:r}=this;r.fillStyle=t.css,r.fillRect(s,i,e,h)}tt(t=l.red,s,i,e,h){let{V:r}=this;r.strokeStyle=t.css,r.lineWidth=1,r.strokeRect(s+1,i+1,e-2,h-2)}st(t,s,i,e=64,h=l.light,r){let{V:n}=this,o=n.measureText(t).width;return"c"===r?(s-=o/2,n.textBaseline="middle"):n.textBaseline="alphabetic",n.font=`${e}px 'Courier New', monospace`,n.fillStyle=h.css,n.fillText(t,s,i),o}it(t,s,i,e=1,h=1){let{fx:r,fy:n,X:o,N:a,q:c,O:l}=t.current_frame,{et:A,ht:u}=t,w=s-r-A,g=i-n-u;this.rt(w,g,o,a,c,l,e,h)}rt(t,s,i,e,h,r,n,o){let{V:c}=this,{K:l}=a;c.save();let A=h,u=r,w=A*Math.abs(n),g=u*Math.abs(o);c.scale(n,o),n<0&&(t*=-1,t-=w),o<0&&(s*=-1,s-=g),c.drawImage(l,i,e,A,u,Math.round(t),Math.round(s),w,g),c.restore()}};s(A,"make",((t,s,i=!0)=>{let e=document.createElement("canvas");i&&e.classList.add("pixelated");let h=e.getContext("2d");const r=()=>{e.width=t,e.height=s,h.imageSmoothingEnabled=i};return document.addEventListener("scroll",r,{capture:!0,passive:!0}),window.addEventListener("resize",r,{passive:!0}),r(),new A(e,h)}));let u=A;const w=(t,s,i,e,h,r)=>t<=h&&h<=t+i&&s<=r&&r<=s+e,g=t=>t.split("r").map((t=>parseFloat(t)));class d{constructor(){s(this,"_data"),s(this,"life"),s(this,"objects"),s(this,"_mouses"),this.nt=[],this.ot=new Map}ct(t){return this.lt=t,this}At(t,s,i,e,h){let r=((t,s,i,e)=>[t,s,i,e].join("r"))(t,s,i,e);this.ot.set(r,{...h,ut:!1})}wt(t,s){return(new t).ct(s).init()}make(t,s={}){let i=this.wt(t,s);return this.nt.push(i),i}remove(t){let s=this.nt.indexOf(t);if(-1===s)throw"noscene rm";this.nt.splice(s,1)}init(){return this.gt=0,this.dt(),this}update(){var t,s,e;if(0===this.gt&&this.ft(),this.nt.forEach((t=>t.update())),this.gt+=i.delta,h.click){let s=320*h.click[0],i=180*h.click[1];for(let[e,h]of this.ot)w(...g(e),s,i)&&(null==(t=h.L)||t.call(h))}if(h.move){let t=320*h.move[0],i=180*h.move[1];for(let[h,r]of this.ot)w(...g(h),t,i)?r.ut||(r.ut=!0,null==(s=r.xt)||s.call(r)):(r.ut&&(null==(e=r._t)||e.call(r)),r.ut=!1)}this.yt()}Qt(t,s){this.Mt(t,s),this.nt.forEach((i=>i.Qt(t,s))),this.Ct(t,s)}dt(){}ft(){}yt(){}Ct(t,s){}Mt(t,s){}}class f extends d{constructor(){super(...arguments),s(this,"x",0),s(this,"y",0),s(this,"scale_x",1),s(this,"scale_y",1),s(this,"_current_frame",0),s(this,"__elapsed",0)}get data(){return this.lt}get info(){let t=a.info.find((t=>t.name));if(!t)throw`nosprite ${this.bt}`;return t}get tag(){let t=this.info.tags.find((t=>t.name===this.Bt));if(!t)throw`notag ${this.bt} ${this.Bt}`;return t}get bt(){return this.data.name}get Bt(){return this.data.tag||"idle"}kt(t,s){this.x=t,this.y=s}get current_frame(){let{from:t}=this.tag;return this.info.W[this._current_frame+t]}get vt(){return this.data.vt??"c"}get et(){if("tl"===this.vt)return 0;let{G:t}=this.current_frame;return"c"===this.vt||"bc"===this.vt?t/2:0}get ht(){if("tl"===this.vt)return 0;let{J:t}=this.current_frame;return"c"===this.vt?t/2:"bc"===this.vt?t:0}Et(t){this.data.tag=t,this._current_frame=0,this.__elapsed=0}yt(){let{from:t,to:s}=this.tag,{duration:e}=this.current_frame,h=s-t;this.__elapsed+=1e3*i.delta,this.__elapsed>=e&&(this.__elapsed-=e,this._current_frame===h?this._current_frame=0:this._current_frame+=1)}Ct(t,s){let{x:i,y:e,Dt:h,Ft:r}=this;t.it(this,i,e,h,r)}}function x(t,s,i){return Math.max(Math.min(t,i),s)}const _=t=>Math.sin(t),p=t=>(t%6.28-3.14)/6.28,m=t=>x(1e3*Math.sin(t),-1,1);let y,Q;y=new AudioContext,Q=y.sampleRate;let M=[["intro",[[0,2,3,5,7,12],1.3],0]],C=[["start",.737,t=>(t*=-999)&&.6*_(t/(20+_(t/900+_(t/440+_(t/222)))-t/400))],["click",.737,t=>(t*=-999)&&.6*_(t/(20+_(t/900+_(t/440+_(t/222)))-t/400))],["tense",1.5,t=>.1*(.5*m(t/800)+.5)*p(t/110)],["short",.4,t=>.03*p(t/4)],["start2",3.321,t=>m(t/(20+t/100))+Math.random()/t*210-6*_(33.22*t)],["sqr",1.1415,t=>m(t/(111-t/54.21))]];const b=async t=>{async function s(){return new Promise((t=>setTimeout(t,0)))}function i(s){t(s)}let e,h,r,n,o,a,c={},l={},A=!0;async function u(t,i){let e=y.createBuffer(1,Q*t,Q),h=e.getChannelData(0),r=e.length;for(let s=0;s<r;s++)h[s]=i(44100*s/Q)*(1-s/r);return await s(),e}async function w([t,i],e){const h=[],r=[],o=[4,2,.5,3,4][e],a=[1,.5,.25,2,2][e++],c=[-15,-20,-19,-12];r.push([e*e*3*.5%2,e%2],[.5*(e*e*3+9*e)%2,(e+1)%2],[.5*(e*e*2+11*e)%2,(e+1)%2]);for(let s=0;s<3;s++){const i=8*s,r=[0,3,-5][s];for(let t=0;t<8;t++)h.push([c[(7*e+2*s+(t>>1)+t*t*3)%4]+r,t+i,6,1]);for(let n=0;n<8/a;n++)(n+n*n+s+3*e)%7<4&&h.push([-3+r+t[(n+n*n*2+s*s*2+e)%t.length],n*a+i,o,2])}const l=y.createBuffer(1,8*Q*3*i,Q),A=l.getChannelData(0);for(let n=0;n<h.length;n++){let t,e,r,o;[t,e,r,o]=h[n];const a=Math.floor(e*i*Q),c=r*i*Q;for(let s=0;s<c;s++){let i=0;const e=s/c;i+=1==o?2*x(_(s/(6*2**(-t/12)*2*2)+_(s/8e3))*(44*Math.exp(23*-e)+1),-1,1):7*p(s/(24.18*2**(-t/12)*2)),A[a+s]+=i*Math.min(e*Math.exp(-e*(10+7*o))*100,1)/500}await s()}for(let u=0;u<44;u+=2){for(let t=0;t<r.length;t++){let s,e;[e,s]=r[t];const h=Math.floor(.5*Q*s),o=Math.floor((e+u)*Q*i);for(let t=0;t<.1*Q;t++)A[t+o]+=n[t+h]}await s()}return l}function g(t){let s=e;t&&(e=y.createBufferSource(),e.buffer=t,e.loop=!0,e.connect(A?o:a),e.start()),setTimeout((()=>{null==s||s.stop()}),700),o.gain.setTargetAtTime(A?1:0,y.currentTime,.5),a.gain.setTargetAtTime(A?0:1,y.currentTime,.5),A=!A}return await async function(){let t=C.length+M.length+1;for(let s in C){let[e,h,r]=C[s],n=await u(h,r);i((Number(s)+1)/t),c[e]=n}r=y.createBuffer(1,Q,Q),n=r.getChannelData(0);const e=.1*Q;for(let s=0;s<e;s++)n[s]+=.01*(_(s/(70+s/300))+Math.random()/3)*(1-s/e),n[Math.floor(.5*Q)+s]+=.01*Math.random()*(1-s/e);await s(),h=y.createBuffer(1,3*Q,Q);const A=h.getChannelData(0);for(let s=0;s<3*Q;s++){const t=s/Q;A[s]=x(Math.sin(s/120)*(10+10*_(s/1e4+t*t*t*4)),-1,1)*t/50}await s();for(let s in M){let[e,h,r]=M[s],n=await w(h,r);i((Number(s)+1)/t),l[e]=n}o=new GainNode(y),o.connect(y.destination),a=new GainNode(y),a.connect(y.destination)}(),[t=>function(t){let s=y.createBufferSource();s.buffer=t,s.connect(y.destination),s.start()}(c[t]),t=>function(t){if(!t)return void g();if(!l[t])throw`nomusic ${t}`;g(l[t])}(t)]},B=class{constructor(){s(this,"_fx"),s(this,"_music"),s(this,"_music_onoff",!0)}async load(t){[this.Lt,this.zt]=await b(t),t(1)}get Ht(){return this.It}set Ht(t){this.It=t,this.It||this.zt()}fx(t){this.Lt(t)}Ut(t){this.Ht&&this.zt(t)}};s(B,"make",(()=>new B));const k=B.make(),v=class{constructor(t,s,i,e,h=!0){this.x=t,this.y=s,this.w=i,this.h=e,this.value=h}};s(v,"rect",((t,s,i,e)=>new v(t,s,i,e))),s(v,"hline",((t,s,i)=>new v(t,s,i,1))),s(v,"vline",((t,s,i)=>new v(t,s,1,i)));let E=v;const D=class{constructor(t){this.grid=t}St(t){let s=Math.floor(t.x/8),i=Math.floor(t.y/8),e=Math.floor((t.x+t.w-1)/8),h=Math.floor((t.y+t.h-1)/8);for(let r=s;r<=e;r++)for(let s=i;s<=h;s++)this.grid[r][s]=t.value}Pt(t,s,i){let{x:e,y:h,w:r,h:n}=t;return this.Yt(e+s,h+i,r,n)}Yt(t,s,i=1,e=1){let h=Math.floor(t/8),r=Math.floor(s/8),n=Math.floor((t+i-1)/8),o=Math.floor((s+e-1)/8);if(h<0||n>=40||r<0||o>=23)throw`outbounds ${t} ${s}`;for(t=h;t<=n;t++)for(s=r;s<=o;s++)if(this.grid[t][s])return!0;return!1}};s(D,"make",(()=>{let t=[];for(let i=0;i<40;i++)t.push(new Array(23).fill(!1));let s=new D(t);return s.St(E.hline(0,172,320)),s}));let F=D,L=[l.red,l.darkred];class z extends d{constructor(){super(...arguments),s(this,"grid")}dt(){this.grid=F.make()}yt(){i.o(.86543)&&([L[1],L[0]]=[L[0],L[1]])}Ct(t){for(let s=0;s<320;s+=8)for(let i=0;i<180;i+=8)this.grid.Yt(s,i)&&t.tt(L[(s+i)/8%2],s,i,8,8)}}const H=((t=1)=>()=>{var s=1e4*Math.sin(t++);return s-Math.floor(s)})();function I(t){return t[function(t,s=H){return Math.floor(s()*t)}(t.length)]}const U=t=>t/320*1920,S=t=>t/180*1080,P=t=>t/1920*320,Y=t=>t/1080*180;class R extends d{constructor(){super(...arguments),s(this,"world"),s(this,"solid")}init(){return this.Rt=this.make(j),this.Zt=this.make(z),this.dt(),this}yt(){let{grid:t}=this.Zt,{jt:s}=this.Rt;s.forEach((s=>{for(let e=0;e<3;e++){let e=Math.abs(s.dx),h=Math.sign(s.dx);for(let n=1/3;n<=e;n+=1/3){if(t.Pt(s,h*n*i.delta,0)){s.dx=0;break}s.x+=h*n*i.delta}let r=Math.abs(s.dy);h=Math.sign(s.dy);for(let n=1/3;n<=r;n+=1/3){if(t.Pt(s,0,h*n*i.delta)){s.dy=0;break}s.y+=h*n*i.delta}}}))}}class Z extends d{constructor(){super(...arguments),s(this,"_w"),s(this,"_h"),s(this,"x"),s(this,"y"),s(this,"dx"),s(this,"dy")}get data(){return this.lt}get w(){return this.Kt}get h(){return this.Wt}init(){return this.x=this.data.x??0,this.y=this.data.y??0,this.Kt=this.data.w,this.Wt=this.data.h,this.dx=0,this.dy=0,super.init()}}class j extends d{get jt(){return this.nt}body(t,s={}){return this.make(t,s)}yt(){}}class K extends Z{constructor(){super(...arguments),s(this,"anim")}get data(){return this.lt}init(){return this.it=this.make(f,this.data),super.init()}update(){this.it.x=this.x,this.it.y=this.y,super.update()}}const W=3.6912;class G extends K{yt(){o.P("left")?(this.it.Dt=-1,this.dx=-3.6912):o.P("right")?(this.it.Dt=1,this.dx=W):this.dx=0}}class J extends d{get data(){return this.lt}Ct(t){let{color:s,x:i,y:e,w:h,h:r}=this.data;t.tt(s,i,e,h,r)}}class X extends d{constructor(){super(...arguments),s(this,"_lerp_to"),s(this,"_lerp_t",0)}get data(){return this.lt}lerp(t,s=.142){this.Gt=t,this.Jt=s}yt(){if(this.Jt>0){let t=1-this.Jt/.2;this.data.color=l.lerp(this.data.color,this.Gt,t),this.Jt-=i.delta,this.Jt<0&&(this.Jt=0)}}Ct(t){let{color:s,x:i,y:e,w:h,h:r}=this.data;t.rect(s,i,e,h,r)}}class N extends d{constructor(){super(...arguments),s(this,"hovering",!1),s(this,"click_t",0),s(this,"w",60),s(this,"h",22),s(this,"bg")}get data(){return this.lt}get x(){return this.data.x}get y(){return this.data.y}dt(){let{w:t,h:s}=this;this.Xt=this.make(X,{color:l.darkblue,x:3,y:2,w:t,h:s}),this.make(J,{color:l.lightblue,x:3,y:2,w:t,h:s}),this.make(it,{x:U(t/2-2),y:S(s/2+2),size:74,text:this.data.text,align:"c"});let i=this;this.At(this.x,this.y,this.w,this.h,{L(){k.fx("click"),i.Nt=.073454,i.Xt.lerp(l.red,i.Nt)},xt(){i.Xt.lerp(l.lightblue)},_t(){i.Xt.lerp(l.darkblue)}})}yt(){this.Nt>0&&(this.Nt-=i.delta,this.Nt<=0&&(this.Nt=0,this.Xt.lerp(l.lightblue,.345)))}Mt(t,s){t.$(this.data.x,this.data.y),s.$(U(this.data.x),S(this.data.y))}Ct(t,s){t.pop(),s.pop()}}class q extends d{constructor(){super(...arguments),s(this,"align"),s(this,"blue_text"),s(this,"retro_text"),s(this,"music_text"),s(this,"music_ontext")}dt(){this.align=[],this.make(X,{color:l.background,x:0,y:0,w:320,h:180}),this.make(X,{color:l.darkblue,x:3,y:2,w:84,h:42}),this.make(J,{color:l.lightblue,x:3,y:2,w:84,h:42}),this.make(J,{color:l.red,x:2,y:1,w:86,h:44}),this.qt=this.make(it,{x:50,y:100,size:74,text:"blue"}),this.Ot=this.make(it,{x:150,y:100,size:74,text:"retro"}),this.align.push({margin:89,h:[this.qt,this.Ot]}),this.make(it,{x:50,y:170,size:54,text:"undescent"}),this.Tt=this.make(it,{x:50,y:228,size:54,text:"music"}),this.Vt=this.make(it,{x:280,y:228,size:54,text:"on"});let t=this;this.At(P(50),Y(174),P(280),Y(54),{L(){console.log("here")},xt(){t.Vt.color=l.red},_t(){t.Vt.color=l.light}}),this.make(N,{x:250,y:4,text:"Right"}),this.make(N,{x:180,y:4,text:"Left"}),this.make(N,{x:220,y:30,text:"Jump"})}yt(){this.align.forEach((t=>{var s;let i=t.margin??0;null==(s=t.h)||s.reduce(((t,s)=>(s.x=t.x+t.width+i,s)))}))}}class O extends d{constructor(){super(...arguments),s(this,"parent")}$t(t,s={}){let i=this.make(t,s);return i.parent=this,i}ts(t,s={}){var i,e;null==(i=this.parent)||i.remove(this),null==(e=this.parent)||e.$t(t,s)}}class T extends O{dt(){this.make(q),this.make(et)}}class V extends O{constructor(){super(...arguments),s(this,"begin_text1"),s(this,"begin_text2"),s(this,"sound_done",!1)}ft(){}dt(){this.make(X,{color:l.darkblue,x:0,y:0,w:320,h:180}),this.make(it,{color:l.lightblue,x:-250,y:1020,size:6e3,text:"V"}),this.make(it,{x:50,y:170,size:112,text:"2 minute ssir..",color:l.light}),this.make(it,{x:960,y:540,size:112,text:"blue",color:l.light}),this.make(it,{x:1280,y:540,size:112,text:"retro",color:l.light}),this.make(it,{x:640,y:900,size:112,text:"by",color:l.light}),this.make(st,{x:840,y:900,size:112,text:"eguneys",color:l.light}),this.ss=this.make(it,{x:960,y:1030,size:62,text:"click to begin",color:l.light}),this.es=this.make(it,{x:2880,y:1030,size:62,text:"click to begin",color:l.light}),k.load((t=>{1===t&&(this.hs=!0)}))}yt(){this.ss.x+=300*i.delta,this.es.x+=300*i.delta,this.ss.x+this.ss.width>1920&&(this.es.x=this.ss.x-1920),this.es.x+this.es.width>1920&&(this.ss.x=this.es.x-1920),this.hs&&h.click&&(k.Ut("intro"),this.ts(T))}}const $=class extends O{dt(){this.$t(V)}Mt(t,s){t.clear(),s.clear()}};s($,"make",(()=>(new $).init()));let tt=$;class st extends d{constructor(){super(...arguments),s(this,"_width",0),s(this,"x"),s(this,"y"),s(this,"size"),s(this,"text"),s(this,"color"),s(this,"lc")}get data(){return this.lt}get width(){return this.rs}get height(){return this.size}dt(){this.text=this.data.text,this.x=this.data.x,this.y=this.data.y,this.size=this.data.size??64,this.color=this.data.color??l.light,this.ns=[]}yt(){i.o(.2)&&(this.ns=this.text.split("").map((t=>[t,I(l.all)])))}Ct(t,s){this.rs=0,this.ns.map((([t,i])=>{let e=s.st(t,this.x+this.rs,this.y,this.size,i);this.rs+=e}))}}class it extends d{constructor(){super(...arguments),s(this,"_width",0),s(this,"x"),s(this,"y"),s(this,"size"),s(this,"text"),s(this,"color")}get data(){return this.lt}get width(){return this.rs}get height(){return this.size}dt(){this.text=this.data.text,this.x=this.data.x,this.y=this.data.y,this.size=this.data.size??64,this.color=this.data.color??l.light}Ct(t,s){this.rs=s.st(this.text,this.x,this.y,this.size,this.color,this.data.align)}}class et extends R{dt(){this.Rt.body(G,{name:"player",x:8,y:8,vt:"bc"}).dy=4}}!async function(t){await a.load(),function(t){let s=u.make(1920,1080,!1),i=u.make(320,180),r=tt.make();e.u({g(){h.update(),o.update(),r.update()},B(){r.Qt(i,s)}}),t.appendChild(i.canvas),t.appendChild(s.canvas),h.I(t)}(t)}(document.getElementById("app"));
