var t=Object.defineProperty,s=(s,i,e)=>(((s,i,e)=>{i in s?t(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e})(s,"symbol"!=typeof i?i+"":i,e),e);const i=new class{constructor(){s(this,"ticks_per_second",1e3),s(this,"ticks",0),s(this,"seconds",0),s(this,"delta",0),s(this,"previous_ticks",0),s(this,"previous_seconds",0),s(this,"pause_timer",0)}t(t){t>=this.i&&(this.i=t)}h(t,s=0){let i=this.o,e=this.delta;return Math.floor((i-s-e)/t)<Math.floor((i-s)/t)}l(t,s){let i=Math.floor(t)-this.delta;return t>=s&&i<s}u(t,s=0){let i=this.o;return h=2*t,(e=i-s)-Math.floor(e/h)*h>=t;var e,h}};const e=new class{constructor(){s(this,"app_time_last"),s(this,"app_time_accumulator",0)}A(t){const s=()=>{t.g()},e=h=>{let r=Math.min(25,h-(this.p??h));this.p=h,this.m+=r,i.delta=r/i.ticks_per_second,i.i>0?i.i-=i.delta:(i.C=i.I,i.I+=r,i.k=i.o,i.o+=i.delta,s()),t._(),requestAnimationFrame(e)};requestAnimationFrame(e)}},h=class{constructor(){s(this,"_btn_pre",!1),s(this,"_btn",0)}get M(){return this.D}get B(){return this.J>0}Y(t){this.J="down"===t?1:0}update(){1!==this.J||this.D?this.D=!1:this.D=!0,1===this.J&&(this.J=2)}};s(h,"make",(()=>new h));let r=h;const n=new class{constructor(){s(this,"action_map"),s(this,"key_map"),this.K={jump:r.make(),left:r.make(),right:r.make(),down:r.make()},this.W={w:"jump",a:"left",s:"down",d:"right",ArrowUp:"jump",ArrowLeft:"left",ArrowDown:"down",ArrowRight:"right"},document.addEventListener("keydown",(t=>{var s;return null==(s=this.K[this.W[t.key]])?void 0:s.Y("down")})),document.addEventListener("keyup",(t=>{var s;return null==(s=this.K[this.W[t.key]])?void 0:s.Y("up")}))}M(t){return this.K[t].M}B(t){return this.K[t].B}update(){for(let t of Object.keys(this.K))this.K[t].update()}};const a=new class{constructor(){s(this,"image"),s(this,"info")}async load(){var t;this.v=await(t="data:image/png;base64,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",new Promise((s=>{let i=new Image;i.onload=()=>s(i),i.src=t}))),this.info="player\n\n0*1*hit\n2*3*jump\n4*5*attack\n6*7*idle\n8*11*walk\n\n4*4*16*16*88*88*24*24\n4*4*16*16*112*88*24*24\n4*4*16*16*88*112*24*24\n4*4*16*16*112*112*24*24\n4*4*16*16*88*136*24*24\n4*4*16*16*112*136*24*24\n4*4*16*16*88*0*24*24\n4*4*16*16*112*0*24*24\n4*4*16*16*88*24*24*24\n4*4*16*16*112*24*24*24\n4*4*16*16*88*48*24*24\n4*4*16*16*112*48*24*24\n\n\nsun\n\n0*0*idle\n1*1*idle2\n\n4*4*80*80*0*0*88*88\n4*4*80*80*0*88*88*88".split("\n\n\n").map((t=>{let[s,i,e]=t.split("\n\n");return{name:s,tags:i.split("\n").map((t=>{let[s,i,e]=t.split("*");return{from:parseInt(s),to:parseInt(i),name:e}})),S:e.split("\n").map((t=>{let[s,i,e,h,r,n,a,o]=t.split("*").map((t=>parseInt(t)));return{fx:s,fy:i,U:e,R:h,T:r,N:n,j:a,F:o,duration:100}}))}}))}},o="#4181bd",c="#b4aec5",l="#eeeaf6",u="#183452",d="#b42c73",A="#de505a",g="#20eea4",x="#8b81b4",w={L:o,background:c,V:l,G:u,q:d,red:A,green:g,P:x,all:[c,u,l,o,A,d,g,x]},p=class{constructor(t,s){this.canvas=t,this.H=s}get width(){return this.canvas.width}get height(){return this.canvas.height}clear(t=w.background){let{H:s}=this;s.clearRect(0,0,this.width,this.height)}rect(t=w.red,s,i,e,h){let{H:r}=this;r.fillStyle=t,r.fillRect(s,i,e,h)}O(t=w.red,s,i,e,h){let{H:r}=this;r.strokeStyle=t,r.lineWidth=1,r.strokeRect(s+1,i+1,e-2,h-2)}X(t,s,i,e=64,h=w.V){let{H:r}=this,n=r.measureText(t).width;return r.font=`${e}px 'Courier New', monospace`,r.fillStyle=h,r.fillText(t,s,i),n}Z(t,s,i,e=1,h=1){let{fx:r,fy:n,T:a,N:o,j:c,F:l}=t.current_frame,{$:u,tt:d}=t,A=s-r-u,g=i-n-d;this.st(A,g,a,o,c,l,e,h)}st(t,s,i,e,h,r,n,o){let{H:c}=this,{v:l}=a;c.save();let u=h,d=r,A=u*Math.abs(n),g=d*Math.abs(o);c.scale(n,o),n<0&&(t*=-1,t-=A),o<0&&(s*=-1,s-=g),c.drawImage(l,i,e,u,d,Math.round(t),Math.round(s),A,g),c.restore()}};s(p,"make",((t,s,i=!0)=>{let e=document.createElement("canvas");i&&e.classList.add("pixelated");let h=e.getContext("2d");const r=()=>{e.width=t,e.height=s,h.imageSmoothingEnabled=i};return document.addEventListener("resize",r),r(),new p(e,h)}));let y=p;class m{constructor(){s(this,"_data"),s(this,"life"),s(this,"objects"),this.it=[]}et(t){return this.ht=t,this}rt(t,s){return(new t).et(s).init()}make(t,s={}){let i=this.rt(t,s);return this.it.push(i),i}remove(t){let s=this.it.indexOf(t);if(-1===s)throw"noscene rm";this.it.splice(s,1)}init(){return this.nt=0,this.ot(),this}update(){0===this.nt&&this.ct(),this.it.forEach((t=>t.update())),this.nt+=i.delta,this.lt()}ut(t,s){this.dt(t,s),this.it.forEach((i=>i.ut(t,s))),this.At(t,s)}ot(){}ct(){}lt(){}At(t,s){}dt(t,s){}}class C extends m{constructor(){super(...arguments),s(this,"x",0),s(this,"y",0),s(this,"scale_x",1),s(this,"scale_y",1),s(this,"_current_frame",0),s(this,"__elapsed",0)}get data(){return this.ht}get info(){let t=a.info.find((t=>t.name));if(!t)throw`nosprite ${this.gt}`;return t}get tag(){let t=this.info.tags.find((t=>t.name===this.xt));if(!t)throw`notag ${this.gt} ${this.xt}`;return t}get gt(){return this.data.name}get xt(){return this.data.tag||"idle"}wt(t,s){this.x=t,this.y=s}get current_frame(){let{from:t}=this.tag;return this.info.S[this._current_frame+t]}get yt(){return this.data.yt??"c"}get $(){if("tl"===this.yt)return 0;let{U:t}=this.current_frame;return"c"===this.yt||"bc"===this.yt?t/2:0}get tt(){if("tl"===this.yt)return 0;let{R:t}=this.current_frame;return"c"===this.yt?t/2:"bc"===this.yt?t:0}Ct(t){this.data.tag=t,this._current_frame=0,this.__elapsed=0}lt(){let{from:t,to:s}=this.tag,{duration:e}=this.current_frame,h=s-t;this.__elapsed+=1e3*i.delta,this.__elapsed>=e&&(this.__elapsed-=e,this._current_frame===h?this._current_frame=0:this._current_frame+=1)}At(t,s){let{x:i,y:e,It:h,kt:r}=this;t.Z(this,i,e,h,r)}}let I={};const k=class{constructor(){s(this,"_fxs")}fx(t){let s=this.Qt[t];if(!s)throw`nosound ${t}`;var i;i=s,console.log(i)}};s(k,"make",(()=>{let t=new k;return t.Qt=I,t}));const Q=new k,E=class{constructor(t,s,i,e,h=!0){this.x=t,this.y=s,this.w=i,this.Et=e,this.value=h}};s(E,"rect",((t,s,i,e)=>new E(t,s,i,e))),s(E,"hline",((t,s,i)=>new E(t,s,i,1))),s(E,"vline",((t,s,i)=>new E(t,s,1,i)));let _=E;const b=class{constructor(t){this.grid=t}_t(t){let s=Math.floor(t.x/8),i=Math.floor(t.y/8),e=Math.floor((t.x+t.w-1)/8),h=Math.floor((t.y+t.Et-1)/8);for(let r=s;r<=e;r++)for(let s=i;s<=h;s++)this.grid[r][s]=t.value}bt(t,s,i){let{x:e,y:h,w:r,Et:n}=t;return this.ft(e+s,h+i,r,n)}ft(t,s,i=1,e=1){let h=Math.floor(t/8),r=Math.floor(s/8),n=Math.floor((t+i-1)/8),a=Math.floor((s+e-1)/8);if(h<0||n>=40||r<0||a>=23)throw`outbounds ${t} ${s}`;for(t=h;t<=n;t++)for(s=r;s<=a;s++)if(this.grid[t][s])return!0;return!1}};s(b,"make",(()=>{let t=[];for(let i=0;i<40;i++)t.push(new Array(23).fill(!1));let s=new b(t);return s._t(_.hline(0,172,320)),s}));let f=b,M=[w.red,w.q];class D extends m{constructor(){super(...arguments),s(this,"grid")}ot(){this.grid=f.make()}At(t){for(let s=0;s<320;s+=8)for(let i=0;i<180;i+=8)this.grid.ft(s,i)&&t.O(M[(s+i)/8%2],s,i,8,8)}}const B=((t=1)=>()=>{var s=1e4*Math.sin(t++);return s-Math.floor(s)})();function J(t){return t[function(t,s=B){return Math.floor(s()*t)}(t.length)]}class Y extends m{constructor(){super(...arguments),s(this,"world"),s(this,"solid")}init(){return this.Mt=this.make(W),this.Dt=this.make(D),this.ot(),this}lt(){let{grid:t}=this.Dt,{Bt:s}=this.Mt;s.forEach((s=>{for(let e=0;e<3;e++){let e=Math.abs(s.dx),h=Math.sign(s.dx);for(let n=1/3;n<=e;n+=1/3){if(t.bt(s,h*n*i.delta,0)){s.dx=0;break}s.x+=h*n*i.delta}let r=Math.abs(s.dy);h=Math.sign(s.dy);for(let n=1/3;n<=r;n+=1/3){if(t.bt(s,0,h*n*i.delta)){s.dy=0;break}s.y+=h*n*i.delta}}}))}}class K extends m{constructor(){super(...arguments),s(this,"_w"),s(this,"_h"),s(this,"x"),s(this,"y"),s(this,"dx"),s(this,"dy")}get data(){return this.ht}get w(){return this.Jt}get Et(){return this.Yt}init(){return this.x=this.data.x??0,this.y=this.data.y??0,this.Jt=this.data.w,this.Yt=this.data.Et,this.dx=0,this.dy=0,super.init()}}class W extends m{get Bt(){return this.it}body(t,s={}){return this.make(t,s)}lt(){}}class v extends K{constructor(){super(...arguments),s(this,"anim")}get data(){return this.ht}init(){return this.Z=this.make(C,this.data),super.init()}update(){this.Z.x=this.x,this.Z.y=this.y,super.update()}}const S=3.6912;class U extends v{lt(){n.B("left")?(this.Z.It=-1,this.dx=-3.6912):n.B("right")?(this.Z.It=1,this.dx=S):this.dx=0}}class R extends m{get data(){return this.ht}At(t){let{color:s,x:i,y:e,w:h,Et:r}=this.data;t.O(s,i,e,h,r)}}class z extends m{get data(){return this.ht}At(t){let{color:s,x:i,y:e,w:h,Et:r}=this.data;t.rect(s,i,e,h,r)}}class T extends m{constructor(){super(...arguments),s(this,"align"),s(this,"blue_text"),s(this,"retro_text")}ot(){this.align=[],this.make(z,{color:w.background,x:0,y:0,w:320,Et:180}),this.make(z,{color:w.G,x:3,y:2,w:84,Et:42}),this.make(R,{color:w.L,x:3,y:2,w:84,Et:42}),this.make(R,{color:w.red,x:2,y:1,w:86,Et:44}),this.Kt=this.make(q,{x:50,y:100,size:74,text:"blue"}),this.Wt=this.make(q,{x:50,y:100,size:74,text:"retro"}),this.align.push({margin:89,Et:[this.Kt,this.Wt]}),this.make(q,{x:50,y:170,size:54,text:"undescent"}),this.make(q,{x:50,y:228,size:54,text:"ipsum dolor"})}lt(){this.align.forEach((t=>{var s;let i=t.margin??0;null==(s=t.Et)||s.reduce(((t,s)=>(s.x=t.x+t.width+i,s)))}))}}class N extends m{constructor(){super(...arguments),s(this,"parent")}vt(t,s={}){let i=this.make(t,s);return i.parent=this,i}St(t,s={}){var i,e;null==(i=this.parent)||i.remove(this),null==(e=this.parent)||e.vt(t,s)}}class j extends N{ot(){this.make(T),this.make(P)}}class F extends N{constructor(){super(...arguments),s(this,"begin_text1"),s(this,"begin_text2")}ct(){}ot(){this.make(z,{color:w.G,x:0,y:0,w:320,Et:180}),this.make(q,{x:50,y:170,size:112,text:"2 minute ssir..",color:w.V}),this.make(q,{x:960,y:540,size:112,text:"blue retro",color:w.V}),this.make(q,{x:640,y:900,size:112,text:"by",color:w.V}),this.make(G,{x:840,y:900,size:112,text:"eguneys",color:w.V}),this.Ut=this.make(q,{x:960,y:1030,size:62,text:"click to begin",color:w.V}),this.Rt=this.make(q,{x:2880,y:1030,size:62,text:"click to begin",color:w.V})}lt(){this.Ut.x+=300*i.delta,this.Rt.x+=300*i.delta,this.Ut.x+this.Ut.width>1920&&(this.Rt.x=this.Ut.x-1920),this.Rt.x+this.Rt.width>1920&&(this.Ut.x=this.Rt.x-1920),n.M("jump")&&(Q.fx("start"),this.St(j))}}const L=class extends N{ot(){this.vt(F)}dt(t,s){t.clear(),s.clear()}};s(L,"make",(()=>(new L).init()));let V=L;class G extends m{constructor(){super(...arguments),s(this,"_width",0),s(this,"x"),s(this,"y"),s(this,"size"),s(this,"text"),s(this,"color"),s(this,"lc")}get data(){return this.ht}get width(){return this.zt}get height(){return this.size}ot(){this.text=this.data.text,this.x=this.data.x,this.y=this.data.y,this.size=this.data.size??64,this.color=this.data.color??w.V,this.Tt=[]}lt(){i.h(.2)&&(this.Tt=this.text.split("").map((t=>[t,J(w.all)])))}At(t,s){this.zt=0,this.Tt.map((([t,i])=>{let e=s.X(t,this.x+this.zt,this.y,this.size,i);this.zt+=e}))}}class q extends m{constructor(){super(...arguments),s(this,"_width",0),s(this,"x"),s(this,"y"),s(this,"size"),s(this,"text"),s(this,"color")}get data(){return this.ht}get width(){return this.zt}get height(){return this.size}ot(){this.text=this.data.text,this.x=this.data.x,this.y=this.data.y,this.size=this.data.size??64,this.color=this.data.color??w.V}At(t,s){this.zt=s.X(this.text,this.x,this.y,this.size,this.color)}}class P extends Y{ot(){this.Mt.body(U,{name:"player",x:8,y:8,yt:"bc"}).dy=4}}!async function(t){await a.load(),function(t){let s=y.make(1920,1080,!1),i=y.make(320,180),h=V.make();e.A({g(){n.update(),h.update()},_(){h.ut(i,s)}}),t.appendChild(i.canvas),t.appendChild(s.canvas)}(t)}(document.getElementById("app"));
